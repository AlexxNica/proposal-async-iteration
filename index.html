<!doctype html>
<head><meta charset="utf-8">
<title>Async Generators</title><script type="application/json" id="menu-search-biblio">{"clauses":{"":{"location":"","id":"","aoid":null,"title":"Properties of AsyncGenerator Instances","number":"3.2"}},"ops":{},"productions":{"prod-GeneratorBody":{"id":"prod-GeneratorBody","location":"","name":"GeneratorBody"},"prod-YieldExpression":{"id":"prod-YieldExpression","location":"","name":"YieldExpression"}},"terms":{},"examples":{},"notes":{},"tables":{},"figures":{}}</script></head><body><div id="menu-toggle">☰</div><div id="menu"><div id="menu-search"><input type="text" id="menu-search-box" placeholder="Search..."><div id="menu-search-results" class="inactive"></div></div><div id="menu-toc"><ol class="toc"><li><span class="item-toggle">◢</span><a href="#" title="Abstract Operations"><span class="secnum">1</span> Abstract Operations</a><ol class="toc"><li><span class="item-toggle-none"></span><a href="#" title="AsyncGeneratorRequest Records"><span class="secnum">1.1</span> AsyncGeneratorRequest Records</a></li><li><span class="item-toggle-none"></span><a href="#" title="GetGeneratorContextKind"><span class="secnum">1.2</span> GetGeneratorContextKind</a></li><li><span class="item-toggle-none"></span><a href="#" title="GetAsyncIterator ( _obj_ )"><span class="secnum">1.3</span> GetAsyncIterator ( <var>obj</var> )</a></li><li><span class="item-toggle-none"></span><a href="#" title="IteratorClose( _iterator_, _completion_, _iteratorKind_ )"><span class="secnum">1.4</span> IteratorClose( <var>iterator</var>, <var>completion</var>, <var>iteratorKind</var> )</a></li><li><span class="item-toggle-none"></span><a href="#" title="AsyncGeneratorStart ( _generator_, _generatorBody_ )"><span class="secnum">1.5</span> AsyncGeneratorStart ( <var>generator</var>, <var>generatorBody</var> )</a></li><li><span class="item-toggle-none"></span><a href="#" title="AsyncGeneratorFulfill ( _generator_, _iterationResult_ )"><span class="secnum">1.6</span> AsyncGeneratorFulfill ( <var>generator</var>, <var>iterationResult</var> )</a></li><li><span class="item-toggle-none"></span><a href="#" title="AsyncGeneratorReject ( _generator_, _exception_ )"><span class="secnum">1.7</span> AsyncGeneratorReject ( <var>generator</var>, <var>exception</var> )</a></li><li><span class="item-toggle-none"></span><a href="#" title="AsyncGeneratorResumeNext ( _generator_ )"><span class="secnum">1.8</span> AsyncGeneratorResumeNext ( <var>generator</var> )</a></li><li><span class="item-toggle-none"></span><a href="#" title="AsyncGeneratorEnqueue ( _generator_, _completion_ )"><span class="secnum">1.9</span> AsyncGeneratorEnqueue ( <var>generator</var>, <var>completion</var> )</a></li><li><span class="item-toggle-none"></span><a href="#" title="AsyncGeneratorYield ( _iterationResult_ )"><span class="secnum">1.10</span> AsyncGeneratorYield ( <var>iterationResult</var> )</a></li><li><span class="item-toggle-none"></span><a href="#" title="AsyncGeneratorAwaitResult ( _asyncResult_ )"><span class="secnum">1.11</span> AsyncGeneratorAwaitResult ( <var>asyncResult</var> )</a></li></ol></li><li><span class="item-toggle">◢</span><a href="#" title="Runtime Semantics"><span class="secnum">2</span> Runtime Semantics</a><ol class="toc"><li><span class="item-toggle-none"></span><a href="#" title="Runtime Semantics: EvaluateBody"><span class="secnum">2.1</span> RS: EvaluateBody</a></li><li><span class="item-toggle-none"></span><a href="#" title="Runtime Semantics: Evaluation"><span class="secnum">2.2</span> RS: Evaluation</a></li><li><span class="item-toggle-none"></span><a href="#" title="Runtime Semantics: Evaluation"><span class="secnum">2.3</span> RS: Evaluation</a></li><li><span class="item-toggle-none"></span><a href="#" title="Runtime Semantics: Evaluation"><span class="secnum">2.4</span> RS: Evaluation</a></li><li><span class="item-toggle-none"></span><a href="#" title="Runtime Semantics: LabelledEvaluation"><span class="secnum">2.5</span> RS: LabelledEvaluation</a></li><li><span class="item-toggle-none"></span><a href="#" title="Runtime Semantics: ForIn/OfHeadEvaluation ( _TDZnames_, _expr_, _iterationKind_ )"><span class="secnum">2.6</span> RS: ForIn/OfHeadEvaluation ( <var>TDZnames</var>, <var>expr</var>, <var>iterationKind</var> )</a></li><li><span class="item-toggle-none"></span><a href="#" title="Runtime Semantics: ForIn/OfBodyEvaluation ( _lhs_, _stmt_, _iterator_, _lhsKind_, _labelSet_, _iteratorKind_ )"><span class="secnum">2.7</span> RS: ForIn/OfBodyEvaluation ( <var>lhs</var>, <var>stmt</var>, <var>iterator</var>, <var>lhsKind</var>, <var>labelSet</var>, <var>iteratorKind</var> )</a></li></ol></li><li><span class="item-toggle">◢</span><a href="#" title="AsyncGenerator Objects"><span class="secnum">3</span> AsyncGenerator Objects</a><ol class="toc"><li><span class="item-toggle">◢</span><a href="#" title="Properties of AsyncGenerator Prototype"><span class="secnum">3.1</span> Properties of AsyncGenerator Prototype</a><ol class="toc"><li><span class="item-toggle-none"></span><a href="#" title="AsyncGenerator.prototype.constructor"><span class="secnum">3.1.1</span> AsyncGenerator.prototype.constructor</a></li><li><span class="item-toggle-none"></span><a href="#" title="AsyncGenerator.prototype.next ( _value_ )"><span class="secnum">3.1.2</span> AsyncGenerator.prototype.next ( <var>value</var> )</a></li><li><span class="item-toggle-none"></span><a href="#" title="AsyncGenerator.prototype.return ( _value_ )"><span class="secnum">3.1.3</span> AsyncGenerator.prototype.return ( <var>value</var> )</a></li><li><span class="item-toggle-none"></span><a href="#" title="AsyncGenerator.prototype.throw ( _exception_ )"><span class="secnum">3.1.4</span> AsyncGenerator.prototype.throw ( <var>exception</var> )</a></li><li><span class="item-toggle-none"></span><a href="#" title="AsyncGenerator.prototype [ @@toStringTag ]"><span class="secnum">3.1.5</span> AsyncGenerator.prototype [ @@toStringTag ]</a></li></ol></li><li><span class="item-toggle-none"></span><a href="#" title="Properties of AsyncGenerator Instances"><span class="secnum">3.2</span> Properties of AsyncGenerator Instances</a></li></ol></li></ol></div></div><h1 class="version">Stage 0 Draft / December 29, 2015</h1><h1 class="title">Async Generators</h1>
<script src="https://bterlson.github.io/ecmarkup/ecmarkup.js" defer=""></script>
<link rel="stylesheet" href="https://bterlson.github.io/ecmarkup/elements.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/styles/solarized_light.min.css">

<emu-clause>
  <h1><span class="secnum">1</span>Abstract Operations<span class="utils"><span class="anchor"><a href="#">#</a></span></span></h1>
  <emu-import href="./abstract-operations.html"><emu-clause>
  <h1><span class="secnum">1.1</span>AsyncGeneratorRequest Records<span class="utils"><span class="anchor"><a href="#">#</a></span></span></h1>
  <p>The AsyncGeneratorRequest is a Record value used to store information about how an async generator should be resumed and contains capabilities for fulfilling or rejecting the corresponding promise.</p>
  <p>They have the following fields:</p>
  <emu-table caption="AsyncGeneratorRequest Record Fields"><figure><figcaption>Table 1: AsyncGeneratorRequest Record Fields</figcaption>
    <table>
      <tbody>
      <tr>
        <th>
          Field Name
        
        </th>
        <th>
          Value
        
        </th>
        <th>
          Meaning
        
        </th>
      </tr>
      <tr>
        <td>
          [[Completion]]
        
        </td>
        <td>
          A <emu-xref aoid="Completion"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-completion-record-specification-type">Completion</a></emu-xref> record
        
        </td>
        <td>
          The completion which should be used to resume the async generator.
        
        </td>
      </tr>
      <tr>
        <td>
          [[Capability]]
        
        </td>
        <td>
          A PromiseCapability record
        
        </td>
        <td>
          The capabilities of the promise for which this record provides a reaction handler.
        
        </td>
      </tr>
      </tbody>
    </table>
  </figure></emu-table>
</emu-clause>

<emu-clause>
  <h1><span class="secnum">1.2</span>GetGeneratorContextKind<span class="utils"><span class="anchor"><a href="#">#</a></span></span></h1>
  <emu-alg><ol><li>Let <var>genContext</var> be the running <emu-xref href="#sec-execution-contexts"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-execution-contexts">execution context</a></emu-xref>.</li><li>Let <var>generator</var> be the Generator component of <var>genContext</var>.</li><li>If <var>generator</var> has an [[AsyncGeneratorState]] internal slot, return <emu-const>async</emu-const>.</li><li>Else, return <emu-const>normal</emu-const>.
  </li></ol></emu-alg>
</emu-clause>

<emu-clause>
  <h1><span class="secnum">1.3</span>GetAsyncIterator ( <var>obj</var> )<span class="utils"><span class="anchor"><a href="#">#</a></span></span></h1>
  <p>The abstract operation GetAsyncIterator with argument <var>obj</var> performs the following steps:</p>
  <emu-alg><ol><li>Let <var>method</var> be ? <emu-xref aoid="GetMethod"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-getmethod">GetMethod</a></emu-xref>(<var>obj</var>, @@asyncIterator).</li><li>If <var>method</var> is <emu-val>undefined</emu-val>, let <emu-val>method</emu-val> be ? <emu-xref aoid="GetMethod"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-getmethod">GetMethod</a></emu-xref>(<var>obj</var>, @@iterator).</li><li>Let <var>iterator</var> be ? <emu-xref aoid="Call"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-call">Call</a></emu-xref>(<var>method</var>, <var>obj</var>).</li><li>If <emu-xref aoid="Type"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-ecmascript-data-types-and-values">Type</a></emu-xref>(<var>iterator</var>) is not Object, throw a <emu-val>TypeError</emu-val> exception.</li><li>Return <var>iterator</var>.
  </li></ol></emu-alg>
</emu-clause>

<emu-clause>
  <h1><span class="secnum">1.4</span>IteratorClose( <var>iterator</var>, <var>completion</var>, <var>iteratorKind</var> )<span class="utils"><span class="anchor"><a href="#">#</a></span></span></h1>
  <p>The abstract operation <emu-xref aoid="IteratorClose"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-iteratorclose">IteratorClose</a></emu-xref> with arguments <var>iterator</var> and <var>completion</var> and optional argument <var>iteratorKind</var> is used to notify an iterator that it should perform any actions it would normally perform when it has reached its completed state.  The value of <var>iteratorKind</var> is either <emu-const>normal</emu-const> or <emu-const>async</emu-const>.</p>
  <emu-alg><ol><li>Assert: <emu-xref aoid="Type"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-ecmascript-data-types-and-values">Type</a></emu-xref>(<var>iterator</var>) is Object.</li><li>Assert: <var>completion</var> is a <emu-xref aoid="Completion"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-completion-record-specification-type">Completion</a></emu-xref> Record.</li><li>If <var>iteratorKind</var> was not passed, let <var>iteratorKind</var> be <emu-const>normal</emu-const>.</li><li>Let <var>return</var> be ? <emu-xref aoid="GetMethod"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-getmethod">GetMethod</a></emu-xref>(<var>iterator</var>, <code>"return"</code>).</li><li>If <var>return</var> is <emu-val>undefined</emu-val>, then<ol><li>Return <emu-xref aoid="Completion"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-completion-record-specification-type">Completion</a></emu-xref>(<var>completion</var>).</li></ol></li><li>Let <var>innerResult</var> be <emu-xref aoid="Call"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-call">Call</a></emu-xref>(<var>return</var>, <var>iterator</var>, « »).</li><li>If <var>innerResult</var> is not an <emu-xref href="#sec-completion-record-specification-type"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-completion-record-specification-type">abrupt completion</a></emu-xref> and <var>iteratorKind</var> is <emu-const>async</emu-const>, then<ol><li>Let <var>innerResult</var> be AsyncFunctionAwait(<var>innerResult</var>).</li></ol></li><li>If <var>completion</var>.[[type]] is <emu-const>throw</emu-const>, return <emu-xref aoid="Completion"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-completion-record-specification-type">Completion</a></emu-xref>(<var>completion</var>).</li><li>If <var>innerResult</var>.[[type]] is <emu-const>throw</emu-const>, return <emu-xref aoid="Completion"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-completion-record-specification-type">Completion</a></emu-xref>(<var>innerResult</var>).</li><li>If <emu-xref aoid="Type"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-ecmascript-data-types-and-values">Type</a></emu-xref>(<var>innerResult</var>.[[value]]) is not Object, throw a <emu-val>TypeError</emu-val> exception.</li><li>Return <emu-xref aoid="Completion"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-completion-record-specification-type">Completion</a></emu-xref>(<var>completion</var>).
  </li></ol></emu-alg>
</emu-clause>

<emu-clause>
  <h1><span class="secnum">1.5</span>AsyncGeneratorStart ( <var>generator</var>, <var>generatorBody</var> )<span class="utils"><span class="anchor"><a href="#">#</a></span></span></h1>
  <p>The abstract operation <emu-xref aoid="GeneratorStart"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-generatorstart">GeneratorStart</a></emu-xref> with arguments <var>generator</var> and <var>generatorBody</var> performs the following steps:</p>
  <emu-alg><ol><li>Assert: <var>generator</var> is an AsyncGenerator instance.</li><li>Assert: The value of the [[AsyncGeneratorState]] internal slot of <var>generator</var> is <emu-val>undefined</emu-val>.</li><li>Let <var>genContext</var> be the running <emu-xref href="#sec-execution-contexts"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-execution-contexts">execution context</a></emu-xref>.</li><li>Set the Generator component of <var>genContext</var> to <var>generator</var>.</li><li>Set the code evaluation state of <var>genContext</var> such that when evaluation is resumed for that <emu-xref href="#sec-execution-contexts"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-execution-contexts">execution context</a></emu-xref> the following steps will be performed:<ol><li>Let <var>result</var> be the result of evaluating <var>generatorBody</var>.</li><li>Assert: If we return here, the async generator either threw an exception or performed either an implicit or explicit return.</li><li>Remove <var>genContext</var> from the <emu-xref href="#sec-execution-contexts"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-execution-contexts">execution context</a></emu-xref> stack and restore the <emu-xref href="#sec-execution-contexts"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-execution-contexts">execution context</a></emu-xref> that is at the top of the <emu-xref href="#sec-execution-contexts"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-execution-contexts">execution context</a></emu-xref> stack as the running <emu-xref href="#sec-execution-contexts"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-execution-contexts">execution context</a></emu-xref>.</li><li>Set <var>generator</var>'s [[AsyncGeneratorState]] internal slot to <code>"completed"</code>.</li><li>If <var>result</var> is a normal completion, then<ol><li>Let <var>resultValue</var> be <emu-val>undefined</emu-val>.</li></ol></li><li>Else,<ol><li>Let <var>resultValue</var> be <var>result</var>.[[value]].</li><li>If <var>result</var>.[[type]] is not <emu-const>return</emu-const>, then<ol><li>Return ! AsyncGeneratorReject(<var>generator</var>, <var>resultValue</var>).</li></ol></li></ol></li><li>Let <var>result</var> be AsyncFunctionAwait(<var>resultValue</var>).</li><li>Let <var>resultValue</var> be <var>result</var>.[[value]].</li><li>If <var>result</var> is an <emu-xref href="#sec-completion-record-specification-type"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-completion-record-specification-type">abrupt completion</a></emu-xref>, then<ol><li>Return ! AsyncGeneratorReject(<var>generator</var>, <var>resultValue</var>).</li></ol></li><li>Return ! AsyncGeneratorFulfill(<var>generator</var>, <emu-xref aoid="CreateIterResultObject"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-createiterresultobject">CreateIterResultObject</a></emu-xref>(<var>resultValue</var>, <emu-val>true</emu-val>)).</li></ol></li><li>Set <var>generator</var>'s [[AsyncGeneratorContext]] internal slot to <var>genContext</var>.</li><li>Set <var>generator</var>'s [[AsyncGeneratorState]] internal slot to <code>"suspendedStart"</code>.</li><li>Set <var>generator</var>'s [[AsyncGeneratorQueue]] internal slot to a new empty <emu-xref href="#sec-list-and-record-specification-type"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-list-and-record-specification-type">List</a></emu-xref>.</li><li>Return <emu-val>undefined</emu-val>.
  </li></ol></emu-alg>
</emu-clause>

<emu-clause>
  <h1><span class="secnum">1.6</span>AsyncGeneratorFulfill ( <var>generator</var>, <var>iterationResult</var> )<span class="utils"><span class="anchor"><a href="#">#</a></span></span></h1>
  <emu-alg><ol><li>Assert: <var>generator</var> is an AsyncGenerator instance.</li><li>Assert: <var>iterationResult</var> is an Object that implements the IteratorResult interface.</li><li>Let <var>queue</var> be the value of the [[AsyncGeneratorQueue]] internal slot of <var>generator</var>.</li><li>Remove the first element from <var>queue</var> and let <var>next</var> be the value of that element.</li><li>Let <var>capability</var> be <var>next</var>.[[Capability]].</li><li>Perform ! <emu-xref aoid="Call"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-call">Call</a></emu-xref>(<var>capability</var>.[[Resolve]], <emu-val>undefined</emu-val>, « <var>iterationResult</var> »).</li><li>Perform ! AsyncGeneratorResumeNext(<var>generator</var>).</li><li>Return <emu-val>undefined</emu-val>.
  </li></ol></emu-alg></emu-clause>


<emu-clause>
  <h1><span class="secnum">1.7</span>AsyncGeneratorReject ( <var>generator</var>, <var>exception</var> )<span class="utils"><span class="anchor"><a href="#">#</a></span></span></h1>
  <emu-alg><ol><li>Assert: <var>generator</var> is an AsyncGenerator instance.</li><li>Let <var>queue</var> be the value of the [[AsyncGeneratorQueue]] internal slot of <var>generator</var>.</li><li>Remove the first element from <var>queue</var> and let <var>next</var> be the value of that element.</li><li>Let <var>capability</var> be <var>next</var>.[[Capability]].</li><li>Perform ! <emu-xref aoid="Call"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-call">Call</a></emu-xref>(<var>capability</var>.[[Reject]], <emu-val>undefined</emu-val>, « <var>exception</var> »).</li><li>Perform ! AsyncGeneratorResumeNext(<var>generator</var>).</li><li>Return <emu-val>undefined</emu-val>.
  </li></ol></emu-alg>
</emu-clause>

<emu-clause>
  <h1><span class="secnum">1.8</span>AsyncGeneratorResumeNext ( <var>generator</var> )<span class="utils"><span class="anchor"><a href="#">#</a></span></span></h1>
  <emu-alg><ol><li>Assert: <var>generator</var> is an AsyncGenerator instance.</li><li>Let <var>state</var> be the value of <var>generator</var>'s [[AsyncGeneratorState]] internal slot.</li><li>Assert: <var>state</var> is not <code>"executing"</code>.</li><li>Let <var>queue</var> be the value of <var>generator</var>'s [[AsyncGeneratorQueue]] internal slot.</li><li>If <var>queue</var> is an empty <emu-xref href="#sec-list-and-record-specification-type"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-list-and-record-specification-type">List</a></emu-xref>, return <emu-val>undefined</emu-val>.</li><li>Let <var>next</var> be the value of the first element of <var>queue</var>.</li><li>Assert: <var>next</var> is an AsyncGeneratorRequest record.</li><li>Let <var>completion</var> be <var>next</var>.[[Completion]].</li><li>If <var>completion</var> is an <emu-xref href="#sec-completion-record-specification-type"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-completion-record-specification-type">abrupt completion</a></emu-xref>, then<ol><li>If <var>state</var> is <code>"suspendedStart"</code>, then<ol><li>Set <var>generator</var>'s [[GeneratorState]] internal slot to <code>"completed"</code>.</li><li>Let <var>state</var> be <code>"completed"</code>.</li></ol></li><li>If <var>state</var> is <code>"completed"</code>, then<ol><li>If <var>completion</var>.[[type]] is <emu-const>return</emu-const>, then<ol><li>Let <var>result</var> be <emu-xref aoid="CreateIterResultObject"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-createiterresultobject">CreateIterResultObject</a></emu-xref>(<var>completion</var>.[[value]], <emu-val>true</emu-val>).</li><li>Return AsyncGeneratorFulfill(<var>generator</var>, <var>result</var>).</li></ol></li><li>Return AsyncGeneratorReject(<var>generator</var>, <var>completion</var>.[[value]]).</li></ol></li></ol></li><li>Else,<ol><li>If <var>state</var> is <code>"completed"</code>, then<ol><li>Return AsyncGeneratorFulfill(<var>generator</var>, <emu-xref aoid="CreateIterResultObject"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-createiterresultobject">CreateIterResultObject</a></emu-xref>(<emu-val>undefined</emu-val>, <emu-val>true</emu-val>)).</li></ol></li></ol></li><li>Assert: <var>state</var> is either <code>"suspendedStart"</code> or <code>"suspendedYield"</code>.</li><li>Let <var>genContext</var> be the value of <var>generator</var>'s [[AsyncGeneratorContext]] internal slot.</li><li>Let <var>callerContext</var> be the running <emu-xref href="#sec-execution-contexts"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-execution-contexts">execution context</a></emu-xref>.</li><li>Suspend <var>callerContext</var>.</li><li>Set <var>generator</var>'s [[AsyncGeneratorState]] internal slot to <code>"executing"</code>.</li><li>Push <var>genContext</var> onto the <emu-xref href="#sec-execution-contexts"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-execution-contexts">execution context</a></emu-xref> stack; <var>genContext</var> is now the running <emu-xref href="#sec-execution-contexts"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-execution-contexts">execution context</a></emu-xref>.</li><li>Resume the suspended evaluation of <var>genContext</var> using <var>completion</var> as the result of the operation that suspended it. Let <var>result</var> be the completion record returned by the resumed computation.</li><li>Assert: <var>result</var> is never an <emu-xref href="#sec-completion-record-specification-type"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-completion-record-specification-type">abrupt completion</a></emu-xref>.</li><li>Assert: When we return here, <var>genContext</var> has already been removed from the <emu-xref href="#sec-execution-contexts"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-execution-contexts">execution context</a></emu-xref> stack and <var>callerContext</var> is the currently running <emu-xref href="#sec-execution-contexts"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-execution-contexts">execution context</a></emu-xref>.</li><li>Return <emu-val>undefined</emu-val>.
  </li></ol></emu-alg>
</emu-clause>

<emu-clause>
  <h1><span class="secnum">1.9</span>AsyncGeneratorEnqueue ( <var>generator</var>, <var>completion</var> )<span class="utils"><span class="anchor"><a href="#">#</a></span></span></h1>
  <emu-alg><ol><li>Assert: <var>generator</var> is an AsyncGenerator instance.</li><li>Assert: <var>completion</var> is a <emu-xref aoid="Completion"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-completion-record-specification-type">Completion</a></emu-xref> Record.</li><li>Let <var>queue</var> be the value of <var>generator</var>'s [[AsyncGeneratorQueue]] internal slot.</li><li>Let <var>capability</var> be ! <emu-xref aoid="NewPromiseCapability"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-newpromisecapability">NewPromiseCapability</a></emu-xref>(%Promise%).</li><li>Let <var>request</var> be AsyncGeneratorRequest{[[Completion]]: <var>completion</var>, [[Capability]]: <var>capability</var>}.</li><li>Append <var>request</var> to the end of <var>queue</var>.</li><li>Let <var>state</var> be the value of <var>generator</var>'s [[AsyncGeneratorState]] internal slot.</li><li>If <var>state</var> is not <code>"executing"</code>, then<ol><li>Perform ! AsyncGeneratorResumeNext(<var>generator</var>).</li></ol></li><li>Return <emu-xref aoid="NormalCompletion"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-normalcompletion">NormalCompletion</a></emu-xref>(<var>capability</var>.[[Promise]]).
  </li></ol></emu-alg>
</emu-clause>

<emu-clause>
  <h1><span class="secnum">1.10</span>AsyncGeneratorYield ( <var>iterationResult</var> )<span class="utils"><span class="anchor"><a href="#">#</a></span></span></h1>
  <emu-alg><ol><li>Assert: <var>iterationResult</var> is an Object that implements the IteratorResult interface.</li><li>Let <var>genContext</var> be the running <emu-xref href="#sec-execution-contexts"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-execution-contexts">execution context</a></emu-xref>.</li><li>Assert: <var>genContext</var> is the <emu-xref href="#sec-execution-contexts"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-execution-contexts">execution context</a></emu-xref> of an async generator.</li><li>Let <var>generator</var> be the value of the Generator component of <var>genContext</var>.</li><li>Set the value of <var>generator</var>'s [[AsyncGeneratorState]] internal slot to <code>"suspendedYield"</code>.</li><li>Remove <var>genContext</var> from the <emu-xref href="#sec-execution-contexts"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-execution-contexts">execution context</a></emu-xref> stack and restore the <emu-xref href="#sec-execution-contexts"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-execution-contexts">execution context</a></emu-xref> that is at the top of the <emu-xref href="#sec-execution-contexts"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-execution-contexts">execution context</a></emu-xref> stack as the running <emu-xref href="#sec-execution-contexts"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-execution-contexts">execution context</a></emu-xref>.</li><li>Set the code evaluation state of <var>genContext</var> such that when evaluation is resumed with a <emu-xref aoid="Completion"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-completion-record-specification-type">Completion</a></emu-xref> <var>resumptionValue</var> the following steps will be performed:<ol><li>Return <var>resumptionValue</var>.</li><li>NOTE: This returns to the evaluation of the YieldExpression production that originally called this abstract operation.</li></ol></li><li>Perform ! AsyncGeneratorFulfill(<var>generator</var>, <var>iterationResult</var>).</li><li>Return <emu-val>undefined</emu-val>.</li><li>NOTE: This returns to the evaluation of the operation that had most previously resumed evaluation of <var>genContext</var>.
  </li></ol></emu-alg>
</emu-clause>

<emu-clause>
  <h1><span class="secnum">1.11</span>AsyncGeneratorAwaitResult ( <var>asyncResult</var> )<span class="utils"><span class="anchor"><a href="#">#</a></span></span></h1>
  <emu-alg><ol><li>Let <var>result</var> be ? AsyncFunctionAwait(<var>asyncResult</var>).</li><li>Let <var>value</var> be ? <emu-xref aoid="IteratorValue"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-iteratorvalue">IteratorValue</a></emu-xref>(<var>result</var>).</li><li>If <emu-xref aoid="Type"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-ecmascript-data-types-and-values">Type</a></emu-xref>(<var>value</var>) is Object, then<ol><li>If ? <emu-xref aoid="IsCallable"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-iscallable">IsCallable</a></emu-xref>(? <emu-xref aoid="Get"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-get-o-p">Get</a></emu-xref>(<var>value</var>, <code>"then"</code>)) is <emu-val>true</emu-val>, then<ol><li>Let <var>done</var> be ? <emu-xref aoid="IteratorComplete"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-iteratorcomplete">IteratorComplete</a></emu-xref>(<var>result</var>).</li><li>Let <var>value</var> be ? AsyncFunctionAwait(<var>value</var>).</li><li>Let <var>result</var> be <emu-xref aoid="CreateIterResultObject"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-createiterresultobject">CreateIterResultObject</a></emu-xref>(<var>value</var>, <var>done</var>).</li></ol></li></ol></li><li>Return <var>result</var>.
  </li></ol></emu-alg>
</emu-clause>
</emu-import>
</emu-clause>

<emu-clause>
  <h1><span class="secnum">2</span>Runtime Semantics<span class="utils"><span class="anchor"><a href="#">#</a></span></span></h1>
  <emu-import href="./runtime-semantics.html"><emu-clause>
  <h1><span class="secnum">2.1</span>Runtime Semantics: EvaluateBody<span class="utils"><span class="anchor"><a href="#">#</a></span></span></h1>
  <p>With parameters <var>functionObject</var> and <emu-xref href="#sec-list-and-record-specification-type"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-list-and-record-specification-type">List</a></emu-xref> <var>argumentsList</var>.</p>
  <emu-grammar collapsed=""><emu-production name="GeneratorBody" id="prod-GeneratorBody">
    <emu-nt><a href="#prod-GeneratorBody">GeneratorBody</a></emu-nt><emu-geq>:</emu-geq><emu-rhs a="8aa65b90"><emu-nt><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#prod-FunctionBody">FunctionBody</a></emu-nt></emu-rhs>
</emu-production></emu-grammar>
  <emu-alg><ol><li>Perform ? <emu-xref aoid="FunctionDeclarationInstantiation"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-functiondeclarationinstantiation">FunctionDeclarationInstantiation</a></emu-xref>(<var>functionObject</var>, <var>argumentsList</var>).</li><li>Let <var>generator</var> be ? <emu-xref aoid="OrdinaryCreateFromConstructor"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-ordinarycreatefromconstructor">OrdinaryCreateFromConstructor</a></emu-xref>(<var>functionObject</var>, <code>"%AsyncGeneratorPrototype%"</code>, « [[AsyncGeneratorState]], [[AsyncGeneratorContext]], [[AsyncGeneratorQueue]] »).</li><li>Perform ! AsyncGeneratorStart(<var>generator</var>, <var>FunctionBody</var>).</li><li>Return <emu-xref aoid="Completion"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-completion-record-specification-type">Completion</a></emu-xref>{[[type]]: <emu-const>return</emu-const>, [[value]]: <var>generator</var>, [[target]]: <emu-const>empty</emu-const>}.
  </li></ol></emu-alg>
</emu-clause>

<emu-clause>
  <h1><span class="secnum">2.2</span>Runtime Semantics: Evaluation<span class="utils"><span class="anchor"><a href="#">#</a></span></span></h1>
  <emu-grammar collapsed=""><emu-production name="YieldExpression" id="prod-YieldExpression">
    <emu-nt><a href="#prod-YieldExpression">YieldExpression</a></emu-nt><emu-geq>:</emu-geq><emu-rhs a="d1df3360"><emu-t>yield</emu-t></emu-rhs>
</emu-production></emu-grammar>
  <emu-alg><ol><li>Let <var>resultObject</var> be <emu-xref aoid="CreateIterResultObject"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-createiterresultobject">CreateIterResultObject</a></emu-xref>(<emu-val>undefined</emu-val>, <emu-val>false</emu-val>).</li><li>If ! GetGeneratorContextKind() is <emu-const>async</emu-const>, then<ol><li>TODO: For consistency, should we await here?  Kinda silly, but...</li><li>Return AsyncGeneratorYield(<var>resultObject</var>).</li></ol></li><li>Return <emu-xref aoid="GeneratorYield"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-generatoryield">GeneratorYield</a></emu-xref>(<var>resultObject</var>).
  </li></ol></emu-alg>
</emu-clause>

<emu-clause>
  <h1><span class="secnum">2.3</span>Runtime Semantics: Evaluation<span class="utils"><span class="anchor"><a href="#">#</a></span></span></h1>
  <emu-grammar collapsed=""><emu-production name="YieldExpression">
    <emu-nt><a href="#prod-YieldExpression">YieldExpression</a></emu-nt><emu-geq>:</emu-geq><emu-rhs a="e741ede8"><emu-t>yield</emu-t><emu-nt><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#prod-AssignmentExpression">AssignmentExpression</a></emu-nt></emu-rhs>
</emu-production></emu-grammar>
  <emu-alg><ol><li>Let <var>exprRef</var> be the result of evaluating <emu-nt><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#prod-AssignmentExpression">AssignmentExpression</a></emu-nt>.</li><li>Let <var>value</var> be ? <emu-xref aoid="GetValue"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-getvalue">GetValue</a></emu-xref>(<var>exprRef</var>).</li><li>If ! GetGeneratorContextKind() is <emu-const>async</emu-const>, then<ol><li>Let <var>value</var> be ? AsyncFunctionAwait(<var>value</var>).</li><li>Return AsyncGeneratorYield(<emu-xref aoid="CreateIterResultObject"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-createiterresultobject">CreateIterResultObject</a></emu-xref>(<var>value</var>, <emu-val>false</emu-val>)).</li></ol></li><li>Return <emu-xref aoid="GeneratorYield"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-generatoryield">GeneratorYield</a></emu-xref>(<emu-xref aoid="CreateIterResultObject"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-createiterresultobject">CreateIterResultObject</a></emu-xref>(<var>value</var>, <emu-val>false</emu-val>)).
  </li></ol></emu-alg>
</emu-clause>

<emu-clause>
  <h1><span class="secnum">2.4</span>Runtime Semantics: Evaluation<span class="utils"><span class="anchor"><a href="#">#</a></span></span></h1>
  <emu-grammar collapsed=""></emu-grammar>
  <emu-alg><ol><li>Let <var>exprRef</var> be the result of evaluating <emu-nt><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#prod-AssignmentExpression">AssignmentExpression</a></emu-nt>.</li><li>Let <var>value</var> be ? <emu-xref aoid="GetValue"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-getvalue">GetValue</a></emu-xref>(<var>exprRef</var>).</li><li>Let <var>iteratorKind</var> be ! GetGeneratorContextKind().</li><li>If <var>iteratorKind</var> is <emu-const>async</emu-const>, let <var>iterator</var> be ? GetAsyncIterator(<var>value</var>).</li><li>Else, let <var>iterator</var> be ? <emu-xref aoid="GetIterator"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-getiterator">GetIterator</a></emu-xref>(<var>value</var>).</li><li>Let <var>received</var> be <emu-xref aoid="NormalCompletion"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-normalcompletion">NormalCompletion</a></emu-xref>(<emu-val>undefined</emu-val>).</li><li>Repeat<ol><li>If <var>received</var>.[[type]] is <emu-const>normal</emu-const>, then<ol><li>Let <var>innerResult</var> be ? <emu-xref aoid="IteratorNext"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-iteratornext">IteratorNext</a></emu-xref>(<var>iterator</var>, <var>received</var>.[[value]]).</li><li>If <var>iteratorKind</var> is <emu-const>async</emu-const>, then<ol><li>Let <var>innerResult</var> be ? AsyncGeneratorAwaitResult(<var>innerResult</var>).</li></ol></li><li>Let <var>done</var> be ? <emu-xref aoid="IteratorComplete"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-iteratorcomplete">IteratorComplete</a></emu-xref>(<var>innerResult</var>).</li><li>If <var>done</var> is <emu-val>true</emu-val>, then<ol><li>Return <emu-xref aoid="IteratorValue"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-iteratorvalue">IteratorValue</a></emu-xref>(<var>innerResult</var>).</li></ol></li><li>If <var>iteratorKind</var> is <emu-const>async</emu-const>, let <var>recieved</var> be AsyncGeneratorYield(<var>innerResult</var>).</li><li>Else, let <var>received</var> be <emu-xref aoid="GeneratorYield"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-generatoryield">GeneratorYield</a></emu-xref>(<var>innerResult</var>).</li></ol></li><li>Else if <var>received</var>.[[type]] is <emu-const>throw</emu-const>, then<ol><li>Let <var>throw</var> be ? <emu-xref aoid="GetMethod"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-getmethod">GetMethod</a></emu-xref>(<var>iterator</var>, <code>"throw"</code>).</li><li>If <var>throw</var> is not <emu-val>undefined</emu-val>, then<ol><li>Let <var>innerResult</var> be ? <emu-xref aoid="Call"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-call">Call</a></emu-xref>(<var>throw</var>, <var>iterator</var>, « <var>received</var>.[[value]] »).</li><li>If <var>iteratorKind</var> is <emu-const>async</emu-const>, then<ol><li>Let <var>innerResult</var> be ? AsyncGeneratorAwaitResult(<var>innerResult</var>).</li></ol></li><li>NOTE: Exceptions from the inner iterator <code>throw</code> method are propagated. Normal completions from an inner <code>throw</code> method are processed similarly to an inner <code>next</code>.</li><li>If <emu-xref aoid="Type"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-ecmascript-data-types-and-values">Type</a></emu-xref>(<var>innerResult</var>) is not Object, throw a <emu-val>TypeError</emu-val> exception.</li><li>Let <var>done</var> be ? <emu-xref aoid="IteratorComplete"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-iteratorcomplete">IteratorComplete</a></emu-xref>(<var>innerResult</var>).</li><li>If <var>done</var> is <emu-val>true</emu-val>, then<ol><li>Let <var>value</var> be ? <emu-xref aoid="IteratorValue"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-iteratorvalue">IteratorValue</a></emu-xref>(<var>innerResult</var>).</li><li>Return <emu-xref aoid="Completion"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-completion-record-specification-type">Completion</a></emu-xref>{[[type]]: <emu-const>return</emu-const>, [[value]]: <var>value</var>, [[target]]: <emu-const>empty</emu-const>}.</li></ol></li><li>If <var>iteratorKind</var> is <emu-const>async</emu-const>, let <var>recieved</var> be AsyncGeneratorYield(<var>innerResult</var>).</li><li>Else, let <var>received</var> be <emu-xref aoid="GeneratorYield"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-generatoryield">GeneratorYield</a></emu-xref>(<var>innerResult</var>).</li></ol></li><li>Else,<ol><li>NOTE: If <var>iterator</var> does not have a <code>throw</code> method, this throw is going to terminate the <code>yield*</code> loop. But first we need to give <var>iterator</var> a chance to clean up.</li><li>Let <var>closeResult</var> be ? <emu-xref aoid="IteratorClose"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-iteratorclose">IteratorClose</a></emu-xref>(<var>iterator</var>, <emu-xref aoid="Completion"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-completion-record-specification-type">Completion</a></emu-xref>{[[type]]: <emu-const>normal</emu-const>, [[value]]: <emu-const>empty</emu-const>, [[target]]: <emu-const>empty</emu-const>}, <var>iteratorKind</var>).</li><li>NOTE: The next step throws a <emu-val>TypeError</emu-val> to indicate that there was a <code>yield*</code> protocol violation: <var>iterator</var> does not have a <code>throw</code> method.</li><li>Throw a <emu-val>TypeError</emu-val> exception.</li></ol></li></ol></li><li>Else,<ol><li>Assert: <var>received</var>.[[type]] is <emu-const>return</emu-const>.</li><li>Let <var>return</var> be ? <emu-xref aoid="GetMethod"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-getmethod">GetMethod</a></emu-xref>(<var>iterator</var>, <code>"return"</code>).</li><li>If <var>return</var> is <emu-val>undefined</emu-val>, return <emu-xref aoid="Completion"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-completion-record-specification-type">Completion</a></emu-xref>(<var>received</var>).</li><li>Let <var>innerReturnResult</var> be ? <emu-xref aoid="Call"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-call">Call</a></emu-xref>(<var>return</var>, <var>iterator</var>, « <var>received</var>.[[value]] »).</li><li>If <var>iteratorKind</var> is <emu-const>async</emu-const>, then<ol><li>Let <var>innerResult</var> be ? AsyncGeneratorAwaitResult(<var>innerResult</var>).</li></ol></li><li>If <emu-xref aoid="Type"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-ecmascript-data-types-and-values">Type</a></emu-xref>(<var>innerReturnResult</var>) is not Object, throw a <emu-val>TypeError</emu-val> exception.</li><li>Let <var>done</var> be ? <emu-xref aoid="IteratorComplete"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-iteratorcomplete">IteratorComplete</a></emu-xref>(<var>innerReturnResult</var>).</li><li>If <var>done</var> is <emu-val>true</emu-val>, then<ol><li>Let <var>value</var> be ? <emu-xref aoid="IteratorValue"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-iteratorvalue">IteratorValue</a></emu-xref>(<var>innerReturnResult</var>).</li><li>Return <emu-xref aoid="Completion"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-completion-record-specification-type">Completion</a></emu-xref>{[[type]]: <emu-const>return</emu-const>, [[value]]: <var>value</var>, [[target]]: <emu-const>empty</emu-const>}.</li></ol></li><li>If <var>iteratorKind</var> is <emu-const>async</emu-const>, let <var>recieved</var> be AsyncGeneratorYield(<var>innerResult</var>).</li><li>Else, let <var>received</var> be <emu-xref aoid="GeneratorYield"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-generatoryield">GeneratorYield</a></emu-xref>(<var>innerResult</var>).
  </li></ol></li></ol></li></ol></emu-alg>
</emu-clause>

<emu-clause>
  <h1><span class="secnum">2.5</span>Runtime Semantics: LabelledEvaluation<span class="utils"><span class="anchor"><a href="#">#</a></span></span></h1>
  <emu-grammar collapsed=""></emu-grammar>
  <emu-alg><ol><li>Let <var>keyResult</var> be the result of performing ? <emu-xref aoid="ForIn/OfHeadEvaluation"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-runtime-semantics-forin-div-ofheadevaluation-tdznames-expr-iterationkind">ForIn/OfHeadEvaluation</a></emu-xref>(BoundNames of <emu-nt><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#prod-ForDeclaration">ForDeclaration</a></emu-nt>, <emu-nt><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#prod-AssignmentExpression">AssignmentExpression</a></emu-nt>, <emu-const>async-iterate</emu-const>).</li><li>Return <emu-xref aoid="ForIn/OfBodyEvaluation"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-runtime-semantics-forin-div-ofbodyevaluation-lhs-stmt-iterator-lhskind-labelset">ForIn/OfBodyEvaluation</a></emu-xref>(<emu-nt><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#prod-ForDeclaration">ForDeclaration</a></emu-nt>, <emu-nt><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#prod-Statement">Statement</a></emu-nt>, <var>keyResult</var>, <emu-const>lexicalBinding</emu-const>, <var>labelSet</var>, <emu-const>async</emu-const>).
  </li></ol></emu-alg>
</emu-clause>

<emu-clause>
  <h1><span class="secnum">2.6</span>Runtime Semantics: ForIn/OfHeadEvaluation ( <var>TDZnames</var>, <var>expr</var>, <var>iterationKind</var> )<span class="utils"><span class="anchor"><a href="#">#</a></span></span></h1>
  <p>The abstract operation <emu-xref aoid="ForIn/OfHeadEvaluation"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-runtime-semantics-forin-div-ofheadevaluation-tdznames-expr-iterationkind">ForIn/OfHeadEvaluation</a></emu-xref> is called with arguments <var>TDZnames</var>, <var>expr</var>, <var>iterationKind</var>, and <var>async</var>. The value of <var>iterationKind</var> is <emu-const>enumerate</emu-const>, <emu-const>iterate</emu-const>, or <emu-const>async-iterate</emu-const>.</p>
  <emu-alg><ol><li>Let <var>oldEnv</var> be the running <emu-xref href="#sec-execution-contexts"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-execution-contexts">execution context</a></emu-xref>'s LexicalEnvironment.</li><li>If <var>TDZnames</var> is not an empty <emu-xref href="#sec-list-and-record-specification-type"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-list-and-record-specification-type">List</a></emu-xref>, then<ol><li>Assert: <var>TDZnames</var> has no duplicate entries.</li><li>Let <var>TDZ</var> be <emu-xref aoid="NewDeclarativeEnvironment"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-newdeclarativeenvironment">NewDeclarativeEnvironment</a></emu-xref>(<var>oldEnv</var>).</li><li>Let <var>TDZEnvRec</var> be <var>TDZ</var>'s <emu-xref href="#sec-lexical-environments"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-lexical-environments">EnvironmentRecord</a></emu-xref>.</li><li>For each string <var>name</var> in <var>TDZnames</var>, do<ol><li>Let <var>status</var> be <var>TDZEnvRec</var>.CreateMutableBinding(<var>name</var>, <emu-val>false</emu-val>).</li><li>Assert: <var>status</var> is never an <emu-xref href="#sec-completion-record-specification-type"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-completion-record-specification-type">abrupt completion</a></emu-xref>.</li></ol></li><li>Set the running <emu-xref href="#sec-execution-contexts"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-execution-contexts">execution context</a></emu-xref>'s LexicalEnvironment to <var>TDZ</var>.</li></ol></li><li>Let <var>exprRef</var> be the result of evaluating the production that is <var>expr</var>.</li><li>Set the running <emu-xref href="#sec-execution-contexts"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-execution-contexts">execution context</a></emu-xref>'s LexicalEnvironment to <var>oldEnv</var>.</li><li>Let <var>exprValue</var> be ? <emu-xref aoid="GetValue"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-getvalue">GetValue</a></emu-xref>(<var>exprRef</var>).</li><li>If <var>iterationKind</var> is <emu-const>enumerate</emu-const>, then<ol><li>If <var>exprValue</var>.[[value]] is <emu-val>null</emu-val> or <emu-val>undefined</emu-val>, then<ol><li>Return <emu-xref aoid="Completion"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-completion-record-specification-type">Completion</a></emu-xref>{[[type]]: <emu-const>break</emu-const>, [[value]]: <emu-const>empty</emu-const>, [[target]]: <emu-const>empty</emu-const>}.</li></ol></li><li>Let <var>obj</var> be <emu-xref aoid="ToObject"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-toobject">ToObject</a></emu-xref>(<var>exprValue</var>).</li><li>Return ? <var>obj</var>.[[Enumerate]]().</li></ol></li><li>Else, if <var>iterationKind</var> is <emu-const>async-iterate</emu-const>, then<ol><li>Return ? GetAsyncIterator(<var>exprValue</var>).</li></ol></li><li>Else,<ol><li>Assert: <var>iterationKind</var> is <emu-const>iterate</emu-const>.</li><li>Return ? <emu-xref aoid="GetIterator"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-getiterator">GetIterator</a></emu-xref>(<var>exprValue</var>).
  </li></ol></li></ol></emu-alg>
</emu-clause>

<emu-clause>
  <h1><span class="secnum">2.7</span>Runtime Semantics: ForIn/OfBodyEvaluation ( <var>lhs</var>, <var>stmt</var>, <var>iterator</var>, <var>lhsKind</var>, <var>labelSet</var>, <var>iteratorKind</var> )<span class="utils"><span class="anchor"><a href="#">#</a></span></span></h1>
  <p>The abstract operation <emu-xref aoid="ForIn/OfBodyEvaluation"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-runtime-semantics-forin-div-ofbodyevaluation-lhs-stmt-iterator-lhskind-labelset">ForIn/OfBodyEvaluation</a></emu-xref> is called with arguments <var>lhs</var>, <var>stmt</var>, <var>iterator</var>, <var>lhsKind</var>, <var>labelSet</var>, and optional argument <var>iteratorKind</var>. The value of <var>lhsKind</var> is either <emu-const>assignment</emu-const>, <emu-const>varBinding</emu-const> or <emu-const>lexicalBinding</emu-const>.  The value of <var>iteratorKind</var> is either <emu-const>normal</emu-const> or <emu-const>async</emu-const>.</p>
  <emu-alg><ol><li>If <var>iteratorKind</var> was not passed, let <var>iteratorKind</var> be <emu-const>normal</emu-const>.</li><li>Let <var>oldEnv</var> be the running <emu-xref href="#sec-execution-contexts"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-execution-contexts">execution context</a></emu-xref>'s LexicalEnvironment.</li><li>Let <var>V</var> be <emu-val>undefined</emu-val>.</li><li>Let <var>destructuring</var> be IsDestructuring of <var>lhs</var>.</li><li>If <var>destructuring</var> is <emu-val>true</emu-val> and if <var>lhsKind</var> is <emu-const>assignment</emu-const>, then<ol><li>Assert: <var>lhs</var> is a <emu-nt><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#prod-LeftHandSideExpression">LeftHandSideExpression</a></emu-nt>.</li><li>Let <var>assignmentPattern</var> be the parse of the source text corresponding to <var>lhs</var> using <emu-nt><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#prod-AssignmentPattern">AssignmentPattern</a></emu-nt> as the goal symbol.</li></ol></li><li>Repeat<ol><li>Let <var>nextResult</var> be ? <emu-xref aoid="IteratorNext"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-iteratornext">IteratorNext</a></emu-xref>(<var>iterator</var>).</li><li>If <var>iteratorKind</var> is <emu-const>async</emu-const>, then<ol><li>Let <var>nextResult</var> be ? AsyncGeneratorAwaitResult(<var>nextResult</var>).</li></ol></li><li>Let <var>done</var> be ? <emu-xref aoid="IteratorComplete"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-iteratorcomplete">IteratorComplete</a></emu-xref>(<var>iterator</var>).</li><li>If <var>done</var> is <emu-val>true</emu-val>, return <emu-xref aoid="NormalCompletion"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-normalcompletion">NormalCompletion</a></emu-xref>(<var>V</var>).</li><li>Let <var>nextValue</var> be ? <emu-xref aoid="IteratorValue"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-iteratorvalue">IteratorValue</a></emu-xref>(<var>nextResult</var>).</li><li>If <var>lhsKind</var> is either <emu-const>assignment</emu-const> or <emu-const>varBinding</emu-const>, then<ol><li>If <var>destructuring</var> is <emu-val>false</emu-val>, then<ol><li>Let <var>lhsRef</var> be the result of evaluating <var>lhs</var> (it may be evaluated repeatedly).</li></ol></li></ol></li><li>Else,<ol><li>Assert: <var>lhsKind</var> is <emu-const>lexicalBinding</emu-const>.</li><li>Assert: <var>lhs</var> is a <emu-nt><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#prod-ForDeclaration">ForDeclaration</a></emu-nt>.</li><li>Let <var>iterationEnv</var> be <emu-xref aoid="NewDeclarativeEnvironment"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-newdeclarativeenvironment">NewDeclarativeEnvironment</a></emu-xref>(<var>oldEnv</var>).</li><li>Perform BindingInstantiation for <var>lhs</var> passing <var>iterationEnv</var> as the argument.</li><li>Set the running <emu-xref href="#sec-execution-contexts"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-execution-contexts">execution context</a></emu-xref>'s LexicalEnvironment to <var>iterationEnv</var>.</li><li>If <var>destructuring</var> is <emu-val>false</emu-val>, then<ol><li>Assert: <var>lhs</var> binds a single name.</li><li>Let <var>lhsName</var> be the sole element of BoundNames of <var>lhs</var>.</li><li>Let <var>lhsRef</var> be <emu-xref aoid="ResolveBinding"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-resolvebinding">ResolveBinding</a></emu-xref>(<var>lhsName</var>).</li><li>Assert: <var>lhsRef</var> is not an <emu-xref href="#sec-completion-record-specification-type"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-completion-record-specification-type">abrupt completion</a></emu-xref>.</li></ol></li></ol></li><li>If <var>destructuring</var> is <emu-val>false</emu-val>, then<ol><li>If <var>lhsRef</var> is an <emu-xref href="#sec-completion-record-specification-type"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-completion-record-specification-type">abrupt completion</a></emu-xref>, then<ol><li>Let <var>status</var> be <var>lhsRef</var>.</li></ol></li><li>Else if <var>lhsKind</var> is <emu-const>lexicalBinding</emu-const>, then<ol><li>Let <var>status</var> be <emu-xref aoid="InitializeReferencedBinding"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-initializereferencedbinding">InitializeReferencedBinding</a></emu-xref>(<var>lhsRef</var>, <var>nextValue</var>).</li></ol></li><li>Else,<ol><li>Let <var>status</var> be <emu-xref aoid="PutValue"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-putvalue">PutValue</a></emu-xref>(<var>lhsRef</var>, <var>nextValue</var>).</li></ol></li></ol></li><li>Else,<ol><li>If <var>lhsKind</var> is <emu-const>assignment</emu-const>, then<ol><li>Let <var>status</var> be the result of performing DestructuringAssignmentEvaluation of <var>assignmentPattern</var> using <var>nextValue</var> as the argument.</li></ol></li><li>Else if <var>lhsKind</var> is <emu-const>varBinding</emu-const>, then<ol><li>Assert: <var>lhs</var> is a <emu-nt><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#prod-ForBinding">ForBinding</a></emu-nt>.</li><li>Let <var>status</var> be the result of performing BindingInitialization for <var>lhs</var> passing <var>nextValue</var> and <emu-val>undefined</emu-val> as the arguments.</li></ol></li><li>Else,<ol><li>Assert: <var>lhsKind</var> is <emu-const>lexicalBinding</emu-const>.</li><li>Assert: <var>lhs</var> is a <emu-nt><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#prod-ForDeclaration">ForDeclaration</a></emu-nt>.</li><li>Let <var>status</var> be the result of performing BindingInitialization for <var>lhs</var> passing <var>nextValue</var> and <var>iterationEnv</var> as arguments.</li></ol></li></ol></li><li>If <var>status</var> is an <emu-xref href="#sec-completion-record-specification-type"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-completion-record-specification-type">abrupt completion</a></emu-xref>, then<ol><li>Set the running <emu-xref href="#sec-execution-contexts"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-execution-contexts">execution context</a></emu-xref>'s LexicalEnvironment to <var>oldEnv</var>.</li><li>Return ? <emu-xref aoid="IteratorClose"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-iteratorclose">IteratorClose</a></emu-xref>(<var>iterator</var>, <var>status</var>, <var>iteratorKind</var>).</li></ol></li><li>Let <var>result</var> be the result of evaluating <var>stmt</var>.</li><li>Set the running <emu-xref href="#sec-execution-contexts"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-execution-contexts">execution context</a></emu-xref>'s LexicalEnvironment to <var>oldEnv</var>.</li><li>If <emu-xref aoid="LoopContinues"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-loopcontinues">LoopContinues</a></emu-xref>(<var>result</var>, <var>labelSet</var>) is <emu-val>false</emu-val>, return ? <emu-xref aoid="IteratorClose"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-iteratorclose">IteratorClose</a></emu-xref>(<var>iterator</var>, <emu-xref aoid="UpdateEmpty"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-updateempty">UpdateEmpty</a></emu-xref>(<var>result</var>, <var>V</var>), <var>iteratorKind</var>).</li><li>If <var>result</var>.[[value]] is not <emu-const>empty</emu-const>, let <var>V</var> be <var>result</var>.[[value]].
  </li></ol></li></ol></emu-alg>
</emu-clause>
</emu-import>
</emu-clause>

<emu-clause>
  <h1><span class="secnum">3</span>AsyncGenerator Objects<span class="utils"><span class="anchor"><a href="#">#</a></span></span></h1>
  <emu-import href="./async-generator-objects.html"><p>An AsyncGenerator object is an instance of an async generator function and conforms to both the AsyncIterator and AsyncIterable interfaces.</p>

<p>AsyncGenerator instances directly inherit properties from the object that is the value of the <code>prototype</code> property of the AsyncGenerator function that created the instance. AsyncGenerator instances indirectly inherit properties from the AsyncGenerator Prototype intrinsic, %AsyncGeneratorPrototype%.</p>

<emu-clause>
  <h1><span class="secnum">3.1</span>Properties of AsyncGenerator Prototype<span class="utils"><span class="anchor"><a href="#">#</a></span></span></h1>
  <p>The AsyncGenerator prototype object is the %AsyncGeneratorPrototype% intrinsic. It is also the initial value of the <code>prototype</code> property of the %AsyncGenerator% intrinsic (the AsyncGeneratorFunction.prototype).</p>
  <p>The AsyncGenerator prototype is an ordinary object. It is not an AsyncGenerator instance and does not have an [[AsyncGeneratorState]] internal slot.</p>
  <p>The value of the [[Prototype]] internal slot of the AsyncGenerator prototype object is the intrinsic object %AsyncIteratorPrototype%. The initial value of the [[Extensible]] internal slot of the AsyncGenerator prototype object is <emu-val>true</emu-val>.</p>
  <p>All AsyncGenerator instances indirectly inherit properties of the AsyncGenerator prototype object.</p>

  <emu-clause>
    <h1><span class="secnum">3.1.1</span>AsyncGenerator.prototype.constructor<span class="utils"><span class="anchor"><a href="#">#</a></span></span></h1>
    <p>The initial value of <code>AsyncGenerator.prototype.constructor</code> is the intrinsic object %AsyncGenerator%.</p>
    <p>This property has the attributes { [[Writable]]: <emu-val>false</emu-val>, [[Enumerable]]: <emu-val>false</emu-val>, [[Configurable]]: <emu-val>true</emu-val> }.</p>
  </emu-clause>

  <emu-clause>
    <h1><span class="secnum">3.1.2</span>AsyncGenerator.prototype.next ( <var>value</var> )<span class="utils"><span class="anchor"><a href="#">#</a></span></span></h1>
    <emu-alg><ol><li>Let <var>generator</var> be the <code>this</code> value.</li><li>Let <var>completion</var> be <emu-xref aoid="NormalCompletion"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-normalcompletion">NormalCompletion</a></emu-xref>(<var>value</var>).</li><li>Return AsyncGeneratorEnqueue(<var>generator</var>, <var>completion</var>).
    </li></ol></emu-alg>
  </emu-clause>

  <emu-clause>
    <h1><span class="secnum">3.1.3</span>AsyncGenerator.prototype.return ( <var>value</var> )<span class="utils"><span class="anchor"><a href="#">#</a></span></span></h1>
    <emu-alg><ol><li>Let <var>generator</var> be the <code>this</code> value.</li><li>Let <var>completion</var> be <emu-xref aoid="Completion"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-completion-record-specification-type">Completion</a></emu-xref>{[[type]]: <emu-const>return</emu-const>, [[value]]: <var>value</var>, [[target]]: <emu-const>empty</emu-const>}.</li><li>Return AsyncGeneratorEnqueue(<var>generator</var>, <var>completion</var>).
    </li></ol></emu-alg>
  </emu-clause>

  <emu-clause>
    <h1><span class="secnum">3.1.4</span>AsyncGenerator.prototype.throw ( <var>exception</var> )<span class="utils"><span class="anchor"><a href="#">#</a></span></span></h1>
    <emu-alg><ol><li>Let <var>generator</var> be the <code>this</code> value.</li><li>Let <var>completion</var> be <emu-xref aoid="Completion"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-completion-record-specification-type">Completion</a></emu-xref>{[[type]]: <emu-const>throw</emu-const>, [[value]]: <var>exception</var>, [[target]]: <emu-const>empty</emu-const>}.</li><li>Return AsyncGeneratorEnqueue(<var>generator</var>, <var>completion</var>).
    </li></ol></emu-alg>
  </emu-clause>

  <emu-clause>
    <h1><span class="secnum">3.1.5</span>AsyncGenerator.prototype [ @@toStringTag ]<span class="utils"><span class="anchor"><a href="#">#</a></span></span></h1>
    <p>The initial value of the @@toStringTag property is the String value <code>"AsyncGenerator"</code>.</p>
    <p>This property has the attributes { [[Writable]]: <emu-val>false</emu-val>, [[Enumerable]]: <emu-val>false</emu-val>, [[Configurable]]: <emu-val>true</emu-val> }.</p>
  </emu-clause>

</emu-clause>

<emu-clause>
  <h1><span class="secnum">3.2</span>Properties of AsyncGenerator Instances<span class="utils"><span class="anchor"><a href="#">#</a></span></span></h1>
  <p>AsyncGenerator instances are initially created with the internal slots described below:</p>
  <emu-table caption="Internal Slots of AsyncGenerator Instances"><figure><figcaption>Table 2: Internal Slots of AsyncGenerator Instances</figcaption>
    <table>
      <tbody>
      <tr>
        <th>
          Internal Slot
        
        </th>
        <th>
          Description
        
        </th>
      </tr>
      <tr>
        <td>
          [[AsyncGeneratorState]]
        
        </td>
        <td>
          The current execution state of the async generator. The possible values are: <emu-val>undefined</emu-val>, <code>"suspendedStart"</code>, <code>"suspendedYield"</code>, <code>"executing"</code>, and <code>"completed"</code>.
        
        </td>
      </tr>
      <tr>
        <td>
          [[AsyncGeneratorContext]]
        
        </td>
        <td>
          The <emu-xref href="#sec-execution-contexts"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-execution-contexts">execution context</a></emu-xref> that is used when executing the code of this async generator.
        
        </td>
      </tr>
      <tr>
        <td>
          [[AsyncGeneratorQueue]]
        
        </td>
        <td>
          A <emu-xref href="#sec-list-and-record-specification-type"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-list-and-record-specification-type">List</a></emu-xref> of AsyncGeneratorRequest records which represent requests to resume the async generator.
        
        </td>
      </tr>
      </tbody>
    </table>
  </figure></emu-table>
</emu-clause>
</emu-import>
</emu-clause>
</body>